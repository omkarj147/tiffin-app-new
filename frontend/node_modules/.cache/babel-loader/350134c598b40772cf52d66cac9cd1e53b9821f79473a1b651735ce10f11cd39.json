{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import'./Wallet.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Wallet=()=>{const navigate=useNavigate();const[balance,setBalance]=useState(0);const[transactions,setTransactions]=useState([]);const[amount,setAmount]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[showAddFunds,setShowAddFunds]=useState(false);const fetchWalletData=async()=>{try{setLoading(true);const token=localStorage.getItem('token');const response=await axios.get('http://localhost:5002/api/wallet/balance',{headers:{Authorization:`Bearer ${token}`}});setBalance(response.data.balance);// Fetch transaction history\nconst transactionsResponse=await axios.get('http://localhost:5002/api/wallet/transactions',{headers:{Authorization:`Bearer ${token}`}});setTransactions(transactionsResponse.data);}catch(err){setError('Failed to fetch wallet data');console.error('Error:',err);}finally{setLoading(false);}};useEffect(()=>{fetchWalletData();},[]);const handleAddFunds=async e=>{e.preventDefault();setError('');try{const token=localStorage.getItem('token');await axios.post('http://localhost:5002/api/wallet/add-funds',{amount:parseFloat(amount)},{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});setAmount('');setShowAddFunds(false);fetchWalletData();// Refresh wallet data\n}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to add funds');}};// Function to handle refunds from admin\nconst handleRefund=async(userId,amount,orderId)=>{try{const token=localStorage.getItem('token');const response=await axios.post('http://localhost:5002/api/wallet/refund',{userId,amount,orderId},{headers:{'Authorization':`Bearer ${token}`,'Content-Type':'application/json'}});if(response.data){setBalance(response.data.balance);fetchWalletData();// Refresh wallet data\n}}catch(error){console.error('Error processing refund:',error);setError('Failed to process refund');}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"wallet-loading\",children:\"Loading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>navigate('/member/dashboard'),children:\"Back to Dashboard\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"My Wallet\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-balance-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Current Balance\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"balance-amount\",children:[\"\\u20B9\",balance.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{className:\"add-funds-button\",onClick:()=>setShowAddFunds(true),children:\"Add Funds\"})]}),showAddFunds&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Add Funds to Wallet\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddFunds,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",step:\"any\",value:amount,onChange:e=>setAmount(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowAddFunds(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Add Funds\"})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"transactions-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Transaction History\"}),transactions.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-transactions\",children:\"No transactions yet\"}):/*#__PURE__*/_jsx(\"div\",{className:\"transactions-list\",children:transactions.map(transaction=>/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-type\",children:[transaction.type==='credit'?'+ ':'- ',\"\\u20B9\",transaction.amount.toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"transaction-description\",children:transaction.description}),/*#__PURE__*/_jsx(\"span\",{className:\"transaction-date\",children:new Date(transaction.createdAt).toLocaleDateString()})]})]},transaction._id))})]})]});};export default Wallet;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","Wallet","navigate","balance","setBalance","transactions","setTransactions","amount","setAmount","loading","setLoading","error","setError","showAddFunds","setShowAddFunds","fetchWalletData","token","localStorage","getItem","response","get","headers","Authorization","data","transactionsResponse","err","console","handleAddFunds","e","preventDefault","post","parseFloat","_err$response","_err$response$data","message","handleRefund","userId","orderId","className","children","onClick","toFixed","onSubmit","type","min","step","value","onChange","target","required","length","map","transaction","description","Date","createdAt","toLocaleDateString","_id"],"sources":["C:/Users/omkar/Desktop/New Project/frontend/src/components/Wallet/Wallet.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport './Wallet.css';\n\nconst Wallet = () => {\n  const navigate = useNavigate();\n  const [balance, setBalance] = useState(0);\n  const [transactions, setTransactions] = useState([]);\n  const [amount, setAmount] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [showAddFunds, setShowAddFunds] = useState(false);\n\n  const fetchWalletData = async () => {\n    try {\n      setLoading(true);\n      const token = localStorage.getItem('token');\n      const response = await axios.get('http://localhost:5002/api/wallet/balance', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setBalance(response.data.balance);\n\n      // Fetch transaction history\n      const transactionsResponse = await axios.get('http://localhost:5002/api/wallet/transactions', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setTransactions(transactionsResponse.data);\n    } catch (err) {\n      setError('Failed to fetch wallet data');\n      console.error('Error:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchWalletData();\n  }, []);\n\n  const handleAddFunds = async (e) => {\n    e.preventDefault();\n    setError('');\n    \n    try {\n      const token = localStorage.getItem('token');\n      await axios.post('http://localhost:5002/api/wallet/add-funds', \n        { amount: parseFloat(amount) },\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-Type': 'application/json'\n          }\n        }\n      );\n      \n      setAmount('');\n      setShowAddFunds(false);\n      fetchWalletData(); // Refresh wallet data\n    } catch (err) {\n      setError(err.response?.data?.message || 'Failed to add funds');\n    }\n  };\n\n  // Function to handle refunds from admin\n  const handleRefund = async (userId, amount, orderId) => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await axios.post(\n        'http://localhost:5002/api/wallet/refund',\n        {\n          userId,\n          amount,\n          orderId\n        },\n        {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Content-Type': 'application/json'\n          }\n        }\n      );\n\n      if (response.data) {\n        setBalance(response.data.balance);\n        fetchWalletData(); // Refresh wallet data\n      }\n    } catch (error) {\n      console.error('Error processing refund:', error);\n      setError('Failed to process refund');\n    }\n  };\n\n  if (loading) return <div className=\"wallet-loading\">Loading...</div>;\n\n  return (\n    <div className=\"wallet-container\">\n      <div className=\"wallet-header\">\n        <button className=\"back-button\" onClick={() => navigate('/member/dashboard')}>\n          Back to Dashboard\n        </button>\n        <h1>My Wallet</h1>\n      </div>\n\n      <div className=\"wallet-balance-card\">\n        <h2>Current Balance</h2>\n        <div className=\"balance-amount\">â‚¹{balance.toFixed(2)}</div>\n        <button \n          className=\"add-funds-button\"\n          onClick={() => setShowAddFunds(true)}\n        >\n          Add Funds\n        </button>\n      </div>\n\n      {showAddFunds && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal\">\n            <h2>Add Funds to Wallet</h2>\n            {error && <div className=\"error-message\">{error}</div>}\n            <form onSubmit={handleAddFunds}>\n              <div className=\"form-group\">\n                <label></label>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  step=\"any\"\n                  value={amount}\n                  onChange={(e) => setAmount(e.target.value)}\n                  required\n                />\n              </div>\n              <div className=\"modal-actions\">\n                <button type=\"button\" onClick={() => setShowAddFunds(false)}>Cancel</button>\n                <button type=\"submit\">Add Funds</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      <div className=\"transactions-section\">\n        <h2>Transaction History</h2>\n        {transactions.length === 0 ? (\n          <p className=\"no-transactions\">No transactions yet</p>\n        ) : (\n          <div className=\"transactions-list\">\n            {transactions.map(transaction => (\n              <div key={transaction._id} className=\"transaction-card\">\n                <div className=\"transaction-type\">\n                  {transaction.type === 'credit' ? '+ ' : '- '}\n                  â‚¹{transaction.amount.toFixed(2)}\n                </div>\n                <div className=\"transaction-details\">\n                  <span className=\"transaction-description\">{transaction.description}</span>\n                  <span className=\"transaction-date\">\n                    {new Date(transaction.createdAt).toLocaleDateString()}\n                  </span>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Wallet;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}